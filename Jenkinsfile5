// Jenkinsfile-simple-test
pipeline {
    agent {
        label 'ubuntu'
    }
    
    stages {
        stage('Test Connection') {
            steps {
                script {
                    echo "Testing connection to Ubuntu Docker Agent..."
                    echo "SSH Port: 2222 (mapped to container port 22)"
                    echo "Java Path: /usr/bin/java"
                    echo "Workspace: /home/jenkins"
                    
                    sh '''
                        # Verify we're on Ubuntu
                        echo "OS: $(cat /etc/os-release | grep PRETTY_NAME)"
                        echo "Kernel: $(uname -r)"
                        echo ""
                        
                        # Verify Java
                        echo "Java location: $(which java)"
                        echo "Java version:"
                        java -version
                        echo ""
                        
                        # Verify we're in correct workspace
                        echo "Current directory: $(pwd)"
                        echo "Should be: /home/jenkins/workspace"
                        echo ""
                        
                        # Create test file
                        echo "Agent test successful!" > agent-test.txt
                        echo "Timestamp: $(date)" >> agent-test.txt
                        echo "Build: ${BUILD_NUMBER}" >> agent-test.txt
                        
                        cat agent-test.txt
                    '''
                }
            }
        }
    }
        
        
    
    post {
        always {
            archiveArtifacts artifacts: 'agent-test.txt', fingerprint: true
            echo "Test completed on Ubuntu agent!"
        }
    }

}


